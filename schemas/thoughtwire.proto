// Thoughtwire Protocol — Auto-generated from protocol.py
// DO NOT EDIT — regenerate with: thoughtwire schema --format protobuf
// Generated: 2026-02-16 20:08:15 UTC
//
// Source: https://github.com/flint-dominic/thoughtwire

syntax = "proto3";

package thoughtwire;

option go_package = "github.com/flint-dominic/thoughtwire/proto";
option java_package = "com.thoughtwire.proto";

// ── Frame Types ──────────────────────────────────────────────────

enum FrameType {
    FT_CHAT = 0;
    FT_VOTE = 1;
    FT_STATE_DIFF = 2;
    FT_ATTENTION = 3;
    FT_SYSTEM = 4;
    FT_HEARTBEAT = 5;
    FT_ERROR = 6;
    FT_ACK = 7;
}

// ── Intents ──────────────────────────────────────────────────────

enum Intent {
    INT_INFORM = 0;
    INT_REQUEST = 1;
    INT_PROPOSE = 2;
    INT_APPROVE = 3;
    INT_REJECT = 4;
    INT_RESPOND = 5;
    INT_QUERY = 6;
    INT_DELEGATE = 7;
}

// ── Channels ─────────────────────────────────────────────────────

enum Channel {
    CH_GENERAL = 0;
    CH_AI_CHAT = 1;
    CH_COUNCIL = 2;
    CH_VOTES = 3;
    CH_SYSTEM = 4;
    CH_DIRECT = 5;
}

// ── Known Agents ─────────────────────────────────────────────────
// Agent IDs are uint32. Known agents:
//   gpt = 0x998FF305
//   nix = 0xC01FF43E
//   llama = 0xC01FF43E
//   gemini = 0xC814C38C

// ── Frame (v1) ───────────────────────────────────────────────────
// Wire format: 14-byte packed header + variable payload
// This protobuf is for interchange/tooling, NOT the wire format.

message Frame {
    uint32 version = 1;        // Protocol version (1 or 2)
    FrameType frame_type = 2;  // Frame type enum
    uint32 agent_id = 3;       // Agent identifier
    uint32 timestamp = 4;      // Unix timestamp (truncated to uint32)
    float confidence = 5;      // 0.0-1.0 (wire: uint8 0-255)
    Intent intent = 6;         // Intent enum
    bytes payload = 7;         // Variable payload (max 65535 bytes)
    
    // v2 signing fields
    bytes signature = 8;       // Ed25519 signature (64 bytes, empty if unsigned)
    bool signed = 9;           // Whether frame carries a signature
    bool verified = 10;        // Whether signature was verified
}

// ── MQTT Topics ──────────────────────────────────────────────────
// Not expressible in protobuf, documented here for reference:
//
//   egregore/council/{channel}       — Council discussion
//   egregore/agent/{id}/response     — Agent responses
//   egregore/direct/{from}/{to}       — Direct messages
//   egregore/system/{event}          — System events
//   egregore/votes/{proposal}        — Governance votes
//   egregore/keys/{agent}            — Public key announcements

// ── Batch ────────────────────────────────────────────────────────

message FrameBatch {
    repeated Frame frames = 1;
    uint32 count = 2;
}

// ── Key Exchange ─────────────────────────────────────────────────

message PublicKey {
    string agent_name = 1;
    uint32 agent_id = 2;
    bytes public_key = 3;      // Ed25519 public key (32 bytes)
    uint32 timestamp = 4;      // When key was generated
}

message KeyRing {
    repeated PublicKey keys = 1;
}
